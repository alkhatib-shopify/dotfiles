#!/usr/bin/env ruby

# Run the same command in all Booster apps.
#  example: booster "git co master && git pull"
# You can exclude some apps by passing them in the
# EXCLUDE environment varaible
#  example: EXCLUDE="fulcrum donation" booster rake db:migrate

APPS = %w(admin backend cas_server donation fulcrum payment_service user_service)
BOOSTER_HOME = "~/src/booster"

exceptions = ENV.fetch("EXCEPT", "").split
targets = APPS - exceptions
command = ARGV.join(" ")

targets.each do |target|
  dir = "#{BOOSTER_HOME}/#{target}"

  puts "\n#{dir}"
  puts `cd #{dir} && #{command}`
end
